<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSEN</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    />

    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />

    <style>
      /* Minimal map styling; you can move this into styles.css */
      #map {
        height: 400px;
        width: 100%;
        margin-top: 1rem;
      }
    </style>
  </head>
  <body class="light-mode">
    <div class="container">
      <header>
        <img src="csen-bw.png" />

        <nav>
          <div class="tabs">
            <button class="tab-btn active" data-tab="calendar">Calendar</button>
            <button class="tab-btn" data-tab="discuss">Discuss</button>
            <button class="tab-btn" data-tab="resources">Resources</button>
          </div>
        </nav>
      </header>

      <main>
        <div class="tab-content active" id="calendar">
          <div class="calendar-layout">
            <div class="calendar-container">
              <h3>NE Scotland Data & Tech Events Community Calendar</h3>
              <div
                data-tockify-component="mini"
                data-tockify-calendar="aberdeentechdata"
              ></div>

              <!-- Leaflet map goes here -->
              <h3 style="margin-top: 1.5rem">Community Institutions Map</h3>
              <div id="map"></div>
            </div>

            <div class="calendar-description">
              <h3>
                Latest Community Newsletters
                <button
                  style="float: right"
                  class="tab-btn"
                  data-tab="subscribe"
                >
                  Subscribe
                </button>
              </h3>
              <h3>
                <i
                  >Due to changes to the Substack API, this is currently
                  unavailable.</i
                >
              </h3>
              <div id="substack-feed-embed"></div>

              <!-- Substack embed code commented out -->
            </div>
          </div>
        </div>

        <div class="tab-content" id="resources">
          <h2>Community Resources</h2>
          <p>You'll be redirected to our resource site shortly...</p>
          <div class="redirect-message">
            <p>
              If you're not redirected automatically, click the button below:
            </p>
            <a href="https://www.csteach.uk" class="cta-button" target="_self"
              >Go to Resources</a
            >
          </div>
        </div>

        <div class="tab-content" id="discuss">
          <h2>Join the Discussion</h2>
          <p>You'll be redirected to our community forum shortly...</p>
          <div class="redirect-message">
            <p>
              If you're not redirected automatically, click the button below:
            </p>
            <a
              href="https://discuss.csteach.uk"
              class="cta-button"
              target="_self"
              >Go to Forum</a
            >
          </div>
        </div>

        <div class="tab-content" id="subscribe">
          <div class="redirect-message">
            <p>
              If you're not redirected automatically, click the button below:
            </p>
            <a
              href="https://csenabz.substack.com/subscribe"
              class="cta-button"
              target="_self"
              >Subscribe on Substack</a
            >
          </div>
        </div>
      </main>

      <footer>
        <p>© 2025 csteach.uk</p>
      </footer>
    </div>

    <script
      data-cfasync="false"
      data-tockify-script="embed"
      src="https://public.tockify.com/browser/embed.js"
    ></script>

    <!-- Leaflet JS -->
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <script>
      // Initialise Leaflet map once DOM is ready
      document.addEventListener("DOMContentLoaded", function () {
        const mapEl = document.getElementById("map");
        if (!mapEl) return;

        const map = L.map("map").setView([57.15, -2.09], 7); // NE Scotland-ish

        L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
          maxZoom: 19,
          attribution: "© OpenStreetMap contributors",
        }).addTo(map);

        // Example marker; you can replace with your own data
        L.marker([57.1497, -2.0943])
          .addTo(map)
          .bindPopup("<strong>Aberdeen</strong><br>Example institution.");
      });
    </script>

    <!-- Your existing script -->
    <script src="script.js"></script>
  </body>
</html>
